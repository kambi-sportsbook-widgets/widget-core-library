CoreLibrary.Component=Stapes.subclass({scope:{},defaultArgs:{},view:null,rootElement:"body",htmlTemplate:null,htmlTemplateFile:null,constructor:function(){if("string"==typeof htmlTemplate&&"string"==typeof htmlTemplateFile)throw new Error("Widget can not have htmlTemplate and htmlTemplateFile set at the same time");this.scope.args=this.defaultArgs||{};var t;t="string"==typeof this.htmlTemplateFile?CoreLibrary.getData(this.htmlTemplate).then(function(t){this.htmlTemplate=t}):new Promise(function(t){t()}),t.then(function(){var t=this.rootElement;"string"==typeof t&&(t=document.querySelector(t)),"string"==typeof this.htmlTemplate&&(t.innerHTML=this.htmlTemplate),this.view=rivets.bind(t,this.scope),CoreLibrary.apiReady===!0?this.init(CoreLibrary.config.arguments):CoreLibrary.init().then(function(t){Object.keys(t).forEach(function(e){this.scope.args[e]=t[e]}.bind(this)),this.init()}.bind(this))["catch"](function(t){})}.bind(this))}})})(),CoreLibrary.ComponentPagination=Stapes.subclass({constructor:function(t,e,i,n,r){this.component=t,this.scope[scopeName]={}}}),window.CoreLibrary=function(){"use strict";function t(t){if(t.status>=200&&t.status<300)return t;var e=new Error(t.statusText);throw e.response=t,e}function e(t){return t.json()}return rivets.formatters["==="]=function(t,e){return t===e},rivets.formatters["=="]=function(t,e){return t==e},rivets.formatters[">="]=function(t,e){return t>=e},rivets.formatters[">"]=function(t,e){return t>e},rivets.formatters["<="]=function(t,e){return e>=t},rivets.formatters["<"]=function(t,e){return e>t},rivets.formatters["!="]=function(t,e){return t!=e},rivets.formatters["!=="]=function(t,e){return t!==e},rivets.formatters.and=function(t,e){return t&&e},rivets.formatters.or=function(t,e){return t||e},rivets.formatters.not=function(t){return!t},rivets.formatters["-"]=function(t,e){return t-e},rivets.formatters["+"]=function(t,e){return t+e},rivets.formatters["*"]=function(t,e){return t*e},rivets.formatters["/"]=function(t,e){return t/e},rivets.binders["style-*"]=function(t,e){t.style.setProperty(this.args[0],e)},rivets.binders.cloak={priority:-1e3,bind:function(t){t.style.opacity=1}},sightglass.adapters=rivets.adapters,sightglass.root=".",{expectedApiVersion:"1.0.0.10",widgetModule:null,offeringModule:null,statisticsModule:null,apiReady:!1,config:{oddsFormat:"decimal",apiVersion:"v2",streamingAllowedForPlayer:!1},height:450,pageInfo:{},init:function(i){return new Promise(function(n,r){window.KambiWidget?window.self===window.top?fetch("mockSetupData.json").then(t).then(e).then(function(t){this.applySetupData(t,i),null!=this.translationModule?this.translationModule.fetchTranslations(t.clientConfig.locale).then(function(){n(t.arguments)}.bind(this)):n(t.arguments)}.bind(this))["catch"](function(t){r()}):(window.KambiWidget.apiReady=function(t){this.widgetModule.api=t,t.VERSION!==this.expectedApiVersion,this.requestSetup(function(t){this.applySetupData(t,i),this.widgetModule.requestBetslipOutcomes(),this.widgetModule.requestOddsFormat(),null!=this.translationModule?this.translationModule.fetchTranslations(t.clientConfig.locale).then(function(){n(t.arguments)}.bind(this)):n(t.arguments)}.bind(this))}.bind(this),window.KambiWidget.receiveResponse=function(t){this.widgetModule.handleResponse(t)}.bind(this)):r()}.bind(this))},applySetupData:function(t,e){null!=t.clientConfig.oddsFormat&&this.setOddsFormat(t.clientConfig.oddsFormat),this.offeringModule.setConfig(t.clientConfig),this.widgetModule.setConfig(t.clientConfig),this.statisticsModule.setConfig(t.clientConfig),this.setPageInfo(t.pageInfo),e===!0&&this.setHeight(t.height),this.init=!0,this.config=t},requestSetup:function(t){this.widgetModule.requestSetup(t)},receiveRespone:function(t){},setOddsFormat:function(t){this.config.oddsFormat=t},setHeight:function(t){this.height=t,this.widgetModule.setHeight(t)},setPageInfo:function(t){"filter"===t.pageType&&"/"!==t.pageParam.substr(-1)&&(t.pageParam+="/"),this.pageInfo=t},getData:function(i){return fetch(i).then(t).then(e)["catch"](function(t){throw t})}}}(),CoreLibrary.offeringModule=function(){"use strict";return{config:{apiBaseUrl:null,apiUrl:null,channelId:null,currency:null,locale:null,market:null,offering:null,customer:null,clientId:null,version:null,routeRoot:"",auth:!1,device:null},setConfig:function(t){for(var e in t)if(t.hasOwnProperty(e)&&this.config.hasOwnProperty(e))switch(this.config[e]=t[e],e){case"locale":}},getGroupEvents:function(t){var e="/event/group/"+t+".json";return this.doRequest(e)},getEventsByFilter:function(t,e){var i="/listView/"+t;return this.doRequest(i,e,"v3")},getLiveEvents:function(){var t="/event/live/open.json";return this.doRequest(t)},doRequest:function(t,e,i){if(null!=this.config.offering){var n=this.config.apiBaseUrl.replace("{apiVersion}",null!=i?i:this.config.version),r=n+this.config.offering+t,s=e||{},o={lang:s.locale||this.config.locale,market:s.market||this.config.market,client_id:s.clientId||this.config.clientId,include:s.include||null};return r+="?"+Object.keys(o).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(o[t])}).join("&"),CoreLibrary.getData(r)}}}}(),CoreLibrary.statisticsModule=function(){"use strict";return{config:{baseApiUrl:"https://api.kambi.com/statistics/api/",offering:null},setConfig:function(t){this.config.offering=t.offering},getStatistics:function(t,e){return e=e.match(/[^?]*/)[0],"/"===e[e.length-1]&&(e=e.slice(0,-1)),CoreLibrary.getData(this.config.baseApiUrl+this.config.offering+"/"+t+"/"+e+".json")}}}(),window.CoreLibrary.translationModule=function(){"use strict";var t={i18nStrings:{},fetchTranslations:function(e){null==e&&(e="en_GB");var i=this;return new Promise(function(n,r){window.CoreLibrary.getData("i18n/"+e+".json").then(function(e){t.i18nStrings=e,n()})["catch"](function(t){"en_GB"!==e?i.fetchTranslations("en_GB").then(n):n()})})}};return rivets.formatters.translate=function(e){return null!=t.i18nStrings[e]?t.i18nStrings[e]:e},t}(),CoreLibrary.widgetModule=function(){"use strict";var t=Stapes.subclass();return{api:{requestSetup:function(){},request:function(){},set:function(){},remove:function(){},createUrl:function(){}},events:new t,config:{routeRoot:"",auth:!1,device:null},setConfig:function(t){for(var e in t)t.hasOwnProperty(e)&&this.config.hasOwnProperty(e)&&(this.config[e]=t[e]);null==this.config.routeRoot?this.config.routeRoot="":this.config.routeRoot.length>0&&"/"!==this.config.routeRoot.slice(-1)&&(this.config.routeRoot+="/")},handleResponse:function(t){switch(t.type){case this.api.WIDGET_HEIGHT:this.events.emit("WIDGET:HEIGHT",t.data);break;case this.api.BETSLIP_OUTCOMES:this.events.emit("OUTCOMES:UPDATE",t.data);break;case this.api.WIDGET_ARGS:this.events.emit("WIDGET:ARGS",t.data);break;case this.api.PAGE_INFO:this.events.emit("PAGE:INFO",t.data);break;case this.api.CLIENT_ODDS_FORMAT:this.events.emit("ODDS:FORMAT",t.data);break;case this.api.CLIENT_CONFIG:this.events.emit("CLIENT:CONFIG",t.data);break;case this.api.USER_LOGGED_IN:this.events.emit("USER:LOGGED_IN",t.data);break;case"Setup":this.events.emit("Setup response",t.data)}},createUrl:function(t,e){return this.api.createUrl(t,e)},getPageType:function(){if(!CoreLibrary.config.pageInfo.pageType)return"";var t=CoreLibrary.config.pageInfo.pageType;switch(t){case"event":return"";case"event-live":return"live/"}},requestSetup:function(t){this.api.requestSetup(t)},requestWidgetHeight:function(){this.api.request(this.api.WIDGET_HEIGHT)},setWidgetHeight:function(t){this.api.set(this.api.WIDGET_HEIGHT,t)},enableWidgetTransition:function(t){t?this.api.set(this.api.WIDGET_ENABLE_TRANSITION):this.api.set(this.api.WIDGET_DISABLE_TRANSITION)},removeWidget:function(){this.api.remove()},navigateToLiveEvent:function(t){this.navigateClient("event/live/"+t)},navigateToEvent:function(t){this.navigateClient("event/"+t)},navigateToFilter:function(t){this.navigateClient(t)},navigateToLiveEvents:function(){this.navigateClient(["in-play"])},addOutcomeToBetslip:function(t,e,i,n){var r=[];t.isArray()?r=t:r.push(t);var s={outcomes:r};null!=e&&(e.isArray()?s.stakes=e:s.stakes=[e]),s.couponType=1===r.length?this.api.BETSLIP_OUTCOMES_ARGS.TYPE_SINGLE:this.api.BETSLIP_OUTCOMES_ARGS.TYPE_COMBINATION,s.updateMode="replace"!==i?this.api.BETSLIP_OUTCOMES_ARGS.UPDATE_APPEND:this.api.BETSLIP_OUTCOMES_ARGS.UPDATE_REPLACE,null!=n&&(s.source=n),this.api.set(this.api.BETSLIP_OUTCOMES,s)},removeOutcomeFromBetslip:function(t){var e=[];t.isArray()?e=t:e.push(t),this.api.set(this.api.BETSLIP_OUTCOMES_REMOVE,{outcomes:e})},requestBetslipOutcomes:function(){this.api.request(this.api.BETSLIP_OUTCOMES)},requestPageInfo:function(){this.api.request(this.api.PAGE_INFO)},requestWidgetArgs:function(){this.api.request(this.api.WIDGET_ARGS)},requestClientConfig:function(){this.api.request(this.api.CLIENT_CONFIG)},requestOddsFormat:function(){this.api.request(this.api.CLIENT_ODDS_FORMAT)},requestOddsAsAmerican:function(t){return new Promise(function(e,i){this.api.requestOddsAsAmerican(t,function(t){e(t)})}.bind(this))},requestOddsAsFractional:function(t){return new Promise(function(e,i){this.api.requestOddsAsFractional(t,function(t){e(t)})})},navigateClient:function(t){if("string"==typeof t)this.api.navigateClient("#"+this.config.routeRoot+t);else if(t.isArray()){var e=this.api.createFilterUrl(t,this.config.routeRoot);this.api.navigateClient(e)}}}}();
