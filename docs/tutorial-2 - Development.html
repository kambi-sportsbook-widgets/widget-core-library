<!DOCTYPE html>




<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Kambi Widgets Tutorial: 2 - Development</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cerulean.css">

</head>

<body>

<style>
    img {
    	max-width: 100%;
    }
</style>

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">Kambi Widgets</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="namespaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="widget-components.html">widget-components</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-coreLibrary.html">coreLibrary</a></li><li><a href="module-eventsModule.html">eventsModule</a></li><li><a href="module-offeringModule.html">offeringModule</a></li><li><a href="module-statisticsModule.html">statisticsModule</a></li><li><a href="module-translationModule.html">translationModule</a></li><li><a href="module-utilModule.html">utilModule</a></li><li><a href="module-widgetModule.html">widgetModule</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="widget-components.DropdownButton.html">widget-components.DropdownButton</a></li><li><a href="widget-components.FixedList.html">widget-components.FixedList</a></li><li><a href="widget-components.Header.html">widget-components.Header</a></li><li><a href="widget-components.OutcomeButton.html">widget-components.OutcomeButton</a></li><li><a href="widget-components.OutcomeButtonUI.html">widget-components.OutcomeButtonUI</a></li><li><a href="widget-components.ScrolledList.html">widget-components.ScrolledList</a></li><li><a href="widget-components.TabPagination.html">widget-components.TabPagination</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="tutorials.list.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="tutorial-1 - Introduction.html">1 - Introduction</a></li><li><a href="tutorial-2 - Development.html">2 - Development</a></li><li><a href="tutorial-3 - Production Builds and Deployment.html">3 - Production Builds and Deployment</a></li><li><a href="tutorial-4 - Fetching Data.html">4 - Fetching Data</a></li><li><a href="tutorial-5 - Sportsbook Interaction.html">5 - Sportsbook Interaction</a></li><li><a href="tutorial-6 - Internationalization.html">6 - Internationalization</a></li><li><a href="tutorial-7 - Styling.html">7 - Styling</a></li><li><a href="tutorial-8 - Using React and widget-components.html">8 - Using React and widget-components</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html#ALIGN_ITEMS">ALIGN_ITEMS</a></li><li><a href="global.html#FixedList_RenderItemContainerArgs">FixedList_RenderItemContainerArgs</a></li><li><a href="global.html#ScrolledList_RenderButtonArgs">ScrolledList_RenderButtonArgs</a></li><li><a href="global.html#ScrolledList_RenderItemContainerArgs">ScrolledList_RenderItemContainerArgs</a></li><li><a href="global.html#TabPagination_RenderTabListArgs">TabPagination_RenderTabListArgs</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			<section class="tutorial-section">

<header>
    

    <h2>2 - Development</h2>
</header>

<article>
    <h3>Running the widget</h3><ul>
<li>Inside the project folder run:</li>
</ul>
<p><code>npm run start</code></p>
<ul>
<li><p>If the build was successful the widget will be running under <code>https://localhost:8080</code> after a few seconds. The server that hosts the widgets code runs under port 8080. That url can be opened directly but some widget features will not work (like changing the widget size or adding bets to the betslip), for all features to work the widget needs to be opened inside the Sportsbook</p>
</li>
<li><p>To open the widget inside the Sportsbook while in development configure a new widget in the <code>widgetSettings</code> to point to to <code>https://localhost:8080/</code>. The Sportsbook requires the widgets to run in HTTPS mode, so in order to see the widget inside the Sportsbook it is required to trust the self-signed certificate that the development server uses. See next section for more information.</p>
</li>
</ul>
<h3>HTTPS certificate</h3><p><code>npm run start</code> starts a built-in webserver (called WebpackDevServer) that hosts the widgets code for development mode. This servers runs under the HTTPS protocol because that is required by the Kambi Sportsbook, as such it has a self-signed certificate which needs to be manually trusted in order to be able to open the widget.</p>
<p>In Chrome and Firefox you can trust the certificate by visiting <code>https://localhost:8080</code> and hitting advance to accept the certificate.</p>
<p>For Microsoft Edge and Internet explorer you need to add the certificate on Windows:</p>
<ul>
<li>Open control panel</li>
<li>Open Internet options</li>
<li>Select content tab</li>
<li>Click on Certificates</li>
<li>Select Trusted Root Certification Authorities</li>
<li>Clici import</li>
<li>Select the certificate from <code>project-folder\node_modules\webpack-dev-server\ssl\server.crt</code></li>
</ul>
<p>This process needs to be done only once per machine.</p>
<h3>Project file structure</h3><pre class="prettyprint source"><code>project
   README.md
   .eslintrc
   .gitignore
   .editorconfig
   LICENSE
   package.json
   dist
   node_modules
   src
      app.scss
      index.html
      index.js
      mockSetupData.json
      i18n
         en_GB.json</code></pre><ul>
<li><p>README.md</p>
<p>Readme for the project</p>
</li>
<li><p>.eslintrc, .gitignore, .editorconfig, postcss.config.js</p>
<p>Configuration files for the project. These files are overwritten everytime the widget is built to make sure that all the widgets have the same files.</p>
</li>
<li><p>LICENSE</p>
<p>License file of the project</p>
</li>
<li><p>package.json</p>
<p>NPM configuration file. This file lists metadata about the project as well as all external dependencies (kambi-widget-core-library, kambi-widget-build-tools, kambi-widget-components and others) it uses. This file needs to be modified to update the dependencies versions</p>
</li>
<li><p>dist</p>
<p>When building the project for production with <code>npm run build</code> the files to be deployed are placed inside this folder</p>
</li>
<li><p>node_modules</p>
<p>All NPM dependencies used in the project are stored in this folder, if the project seems to be missing or using outdated dependencies delete this folder and run <code>npm install</code> to download fresh versions of all the dependencies</p>
</li>
<li><p>src</p>
<p>This folder holds the source code for the widget</p>
</li>
<li><p>src/app.scss</p>
<p>SCSS file with styling rules for this widget, this file is converted to regular CSS which is then included in the page during the build process. SCSS is a superset of CSS and as such all CSS is also valid SCSS, so normal CSS can be placed in this file. More information on SCSS <a href="http://sass-lang.com/">here</a></p>
</li>
<li><p>src/index.html</p>
<p>The markup of the widget, ideally the widget should only change the <code>&lt;body&gt;</code> section of this file. Additional files/libraries should not be included in as <code>&lt;script&gt;</code> tags in the page, instead they should be included by <code>import</code>ing them inside index.js, although it is still possible to do so. See the following sections on how to add dependencies to the project</p>
</li>
<li><p>src/index.js</p>
<p>This is the main javascript file of the project, see the following sections on how to use it</p>
</li>
<li><p>src/mockSetupData.json</p>
<p>This file is used ONLY when opening the widget OUTSIDE of the Kambi Sportsbook (that means accessing https://localhost:8080/ directly), it mocks values that would normally be passed by the Sportsbook to the widget. By changing values in this file you can test how the widget will look like and behave in different configurations, for example in another language.</p>
<p>For more information check the API documentation for <code>coreLibrary.config</code>, <code>coreLibrary.args</code> and <code>coreLibrary.pageInfo</code></p>
</li>
<li><p>src/i18n<br>This folder holds all the internationalization JSON files of the widget, these are used by the <code>translationModule</code>. The use of these files are optional if no internationalization is required. If the user locale is not found in this folder it will fallback to <code>en_GB.json</code>. These are all the currently supported locales in the Sportsbook, although they can vary by operator:</p>
<p>cs_CZ.json, de_DE.json, es_ES.json, fr_CH.json, lt_LT.json, no_NO.json, ro_RO.json, da_DK.json, el_GR.json, et_EE.json, fr_FR.json, lv_LV.json, pl_PL.json, ru_RU.json, de_AT.json, en_AU.json, fi_FI.json, hu_HU.json, nl_BE.json, pt_BR.json, sv_SE.json, de_CH.json, en_GB.json, fr_BE.json, it_IT.json, nl_NL.json, pt_PT.json, tr_TR.json</p>
</li>
</ul>
<h3>Core Library and Build Tools</h3><p>By default a widget project uses these two dependencies:</p>
<ul>
<li><code>kambi-widget-core-library</code></li>
</ul>
<p>Core package with wrappers around Kambi's Widget API (which allows interaction with the Sportsbook) and Offering API (with which you can fetch data from the server) as well as a internationalization API.</p>
<ul>
<li><code>kambi-widget-build-tools</code></li>
</ul>
<p>Package that contains the build process for the widget projects as well as a template for creating new widget projects. Includes a built-in web server with HTTPS support in order to be able to test widgets with</p>
<p>These dependencies are external to the project and as such have their own specific versions, you can check their versions inside the <code>package.json</code> file.</p>
<h3>Importing and Exporting Files</h3><p>The widget uses <a href="https://webpack.github.io/">webpack</a> to transpile, minify, concatenate, bundle all the files and their dependencies together. This is all done automatically by the scripts <code>npm run start</code> (which also starts a webserver for development) and <code>npm run build</code>. All the webpack configuration is already done by those scripts and as such no configuration is required by the user. However the way that the files are bundled together requires them to be referenced in order for them to be included in the final bundle.</p>
<p>The <code>entry</code> point of the application is <code>src/index.js</code>, this file needs to reference (import) directly or indirectly all other files used, this means even HTML and CSS files. The template project that is generated by <code>kambi-widgets-cli init</code> shows this:</p>
<pre class="prettyprint source lang-javascript"><code>import {
   coreLibrary,
   widgetModule,
   offeringModule
} from 'kambi-widget-core-library';
import './index.html';
import './app.scss';

...</code></pre><p>As can be seen here, that file imports <code>coreLibrary</code>, <code>widgetModule</code> and <code>offeringModule</code> from <code>kambi-widget-core-library</code> as well as importing the <code>./index.html</code> and <code>./app.scss</code>. If those files were not imported they would not be included in the final bundled version (<code>index.html</code> would be missing in the <code>dist</code> folder for example).</p>
<p>Imports that start with <code>./</code> mean that they are importing other files in the same project, while those without <code>./</code> are importing files that are dependencies of the project (see next few sections for more information). So it is possible to split the widgets code in multiple javascript files.</p>
<p>More information about exports and imports can be seen <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/import">here</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export">here</a></p>
<h3>Basic Code Setup</h3><p>All widgets need to start by calling <code>coreLibrary.init()</code> and passing it the default arguments that the widget receives. These arguments can be overwritten by the Sportsbook (or inside <code>src/mockSetupData.json</code> arguments attribute when running the widget outside the sportsbook). <code>coreLibrary.init()</code> returns a <code>Promise</code> object which is a way to deal with asynchronous requests (all calls to fetch data in <code>kambi-widget-core-library</code> return <code>Promise</code>s).</p>
<p>You can learn more about <code>Promise</code>s <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise">here</a>. Examples about <code>Promise</code>s can also be seen in section <code>4 - Fetching Data</code>.</p>
<pre class="prettyprint source lang-javascript"><code>coreLibrary.init({
   // default arguments
   title: 'Hello World'
}).then(function () {
   // retrieved arguments
   var args = coreLibrary.args;

   // receiving the title through this widget arguments
   document.getElementById('title').innerText = args.title;
});</code></pre><p>The above code simply sets the header text of the widget to be <code>&quot;Hello World&quot;</code> unless it was defined by the Sportsbook (through the args passed to the widget) to be something else.</p>
<h3>Adding an external Dependency</h3><p>With the basic setup you only have access to the <code>kambi-widget-core-library</code> in the project, which can make it hard to do complex widgets using only plain Javascript. If we wanted to add a library to make our life easier we could do so by adding a <code>&lt;script&gt;</code> tag in the <code>&lt;head&gt;</code> section of the page and using it by accessing the global values it defines, but that is not the recommended way of doing this because it can be hard to keep track of all the dependencies the project will need. As an alternative you can also add dependencies using <code>npm</code>. For example to add jquery to the project all we need to do is run this in the command line:</p>
<p><code>npm install --save jquery</code></p>
<p>and start using it by <code>import</code>ing it in the javascript:</p>
<pre class="prettyprint source lang-javascript"><code>import {
   coreLibrary
} from 'kambi-widget-core-library';
import './index.html';
import './app.scss';
import $ from 'jquery';

coreLibrary.init({
   // default arguments
   title: 'Hello World'
}).then(function () {
   // retrieved arguments
   var args = coreLibrary.args;

   // receiving the title through this widget arguments
   $('#title').text(args.title);
});</code></pre><p>In this manner it is not necessary change <code>index.html</code> to add javascript libraries and stylesheets. You can see a list of all available libraries in the <a href="https://www.npmjs.com/">npm registry</a></p>
<h3>Coding Style</h3><p>The project has linting provided by <a href="http://eslint.org/">eslint</a>. Linters enforce code-style guidelines. They can be configured to appear in your text editor (most have built-in support or a plugin to add support for eslint), but they are also verified at build time. They generate linting errors, but if they happen they do not break the build. So if desired these linting errors can be ignored. In order to keep the coding style consistent across projects the eslint rules are not customizable on a project-by-project basis.</p>
<p>The most important part of the coding style rules is that the default indentation level is set to 3 spaces.</p>
<h3>Common Build Architecture</h3><p> Since all webpack build configuration of the widgets is shared and localized in the <code>kambi-widget-build-tools</code> dependency it is not possible to add more items to the build architecture. For example replacing SCSS with LESS is not possible. We might add some scape hatches in the future to support customizing the webpack configuration to allow modifying the build process, but for now that is not possible.</p>
<h3>ES6 and JSX</h3><p>The project has Babel <a href="https://babeljs.io/">transpilation</a> step process set up during the build so it supports the full <a href="https://babeljs.io/docs/learn-es2015/">ES6 syntax</a> and JSX for React development in all browsers. These new syntaxes are completely optional and can be ignored completely if so desired.</p>
<p>Important: Babel only transpiles ES6 syntax, but not ES6 features like <a href="https://developer.mozilla.org/en/docs/Web/API/Fetch_API">fetch API</a>. New ES6 features need to be polyfilled in to support old browsers (for example IE11 does not support fetch API), the <code>kambi-widget-core-library</code> polyfills ES6 <code>Promise</code>s so those can be safely used no matter the target browser.</p>
<p>Besides ES6 the build process also supports JSX for React development. The only caveat is that JSX syntax is only supported in <code>.jsx</code> files. Since the entry point of the project is <code>src/index.js</code> that file needs to <code>import</code> another <code>.jsx</code> file in order to enable JSX. See more about this in section 8 - Using React and widget-components.</p>
</article>

</section>

		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>